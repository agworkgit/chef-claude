{"ast":null,"code":"/**\n * See the registered mapping of HF model ID => Black Forest Labs model ID here:\n *\n * https://huggingface.co/api/partners/blackforestlabs/models\n *\n * This is a publicly available mapping.\n *\n * If you want to try to run inference for a new model locally before it's registered on huggingface.co,\n * you can add it to the dictionary \"HARDCODED_MODEL_ID_MAPPING\" in consts.ts, for dev purposes.\n *\n * - If you work at Black Forest Labs and want to update this mapping, please use the model mapping API we provide on huggingface.co\n * - If you're a community member and want to add a new supported HF model to Black Forest Labs, please open an issue on the present repo\n * and we will tag Black Forest Labs team members.\n *\n * Thanks!\n */\nimport { InferenceClientInputError, InferenceClientProviderApiError, InferenceClientProviderOutputError } from \"../errors.js\";\nimport { getLogger } from \"../lib/logger.js\";\nimport { delay } from \"../utils/delay.js\";\nimport { omit } from \"../utils/omit.js\";\nimport { TaskProviderHelper } from \"./providerHelper.js\";\nconst BLACK_FOREST_LABS_AI_API_BASE_URL = \"https://api.us1.bfl.ai\";\nexport class BlackForestLabsTextToImageTask extends TaskProviderHelper {\n  constructor() {\n    super(\"black-forest-labs\", BLACK_FOREST_LABS_AI_API_BASE_URL);\n  }\n  preparePayload(params) {\n    return {\n      ...omit(params.args, [\"inputs\", \"parameters\"]),\n      ...params.args.parameters,\n      prompt: params.args.inputs\n    };\n  }\n  prepareHeaders(params, binary) {\n    const headers = {\n      Authorization: params.authMethod !== \"provider-key\" ? `Bearer ${params.accessToken}` : `X-Key ${params.accessToken}`\n    };\n    if (!binary) {\n      headers[\"Content-Type\"] = \"application/json\";\n    }\n    return headers;\n  }\n  makeRoute(params) {\n    if (!params) {\n      throw new InferenceClientInputError(\"Params are required\");\n    }\n    return `/v1/${params.model}`;\n  }\n  async getResponse(response, url, headers, outputType) {\n    const logger = getLogger();\n    const urlObj = new URL(response.polling_url);\n    for (let step = 0; step < 5; step++) {\n      await delay(1000);\n      logger.debug(`Polling Black Forest Labs API for the result... ${step + 1}/5`);\n      urlObj.searchParams.set(\"attempt\", step.toString(10));\n      const resp = await fetch(urlObj, {\n        headers: {\n          \"Content-Type\": \"application/json\"\n        }\n      });\n      if (!resp.ok) {\n        throw new InferenceClientProviderApiError(\"Failed to fetch result from black forest labs API\", {\n          url: urlObj.toString(),\n          method: \"GET\",\n          headers: {\n            \"Content-Type\": \"application/json\"\n          }\n        }, {\n          requestId: resp.headers.get(\"x-request-id\") ?? \"\",\n          status: resp.status,\n          body: await resp.text()\n        });\n      }\n      const payload = await resp.json();\n      if (typeof payload === \"object\" && payload && \"status\" in payload && typeof payload.status === \"string\" && payload.status === \"Ready\" && \"result\" in payload && typeof payload.result === \"object\" && payload.result && \"sample\" in payload.result && typeof payload.result.sample === \"string\") {\n        if (outputType === \"json\") {\n          return payload.result;\n        }\n        if (outputType === \"url\") {\n          return payload.result.sample;\n        }\n        const image = await fetch(payload.result.sample);\n        return await image.blob();\n      }\n    }\n    throw new InferenceClientProviderOutputError(`Timed out while waiting for the result from black forest labs API - aborting after 5 attempts`);\n  }\n}","map":{"version":3,"names":["InferenceClientInputError","InferenceClientProviderApiError","InferenceClientProviderOutputError","getLogger","delay","omit","TaskProviderHelper","BLACK_FOREST_LABS_AI_API_BASE_URL","BlackForestLabsTextToImageTask","constructor","preparePayload","params","args","parameters","prompt","inputs","prepareHeaders","binary","headers","Authorization","authMethod","accessToken","makeRoute","model","getResponse","response","url","outputType","logger","urlObj","URL","polling_url","step","debug","searchParams","set","toString","resp","fetch","ok","method","requestId","get","status","body","text","payload","json","result","sample","image","blob"],"sources":["/Users/agmacbook/Documents/Courses/Meta - Full Stack/Exercises/meta_fullstack_exercises/6_react_basics/12_review/13_chef_claude/node_modules/@huggingface/inference/dist/esm/providers/black-forest-labs.js"],"sourcesContent":["/**\n * See the registered mapping of HF model ID => Black Forest Labs model ID here:\n *\n * https://huggingface.co/api/partners/blackforestlabs/models\n *\n * This is a publicly available mapping.\n *\n * If you want to try to run inference for a new model locally before it's registered on huggingface.co,\n * you can add it to the dictionary \"HARDCODED_MODEL_ID_MAPPING\" in consts.ts, for dev purposes.\n *\n * - If you work at Black Forest Labs and want to update this mapping, please use the model mapping API we provide on huggingface.co\n * - If you're a community member and want to add a new supported HF model to Black Forest Labs, please open an issue on the present repo\n * and we will tag Black Forest Labs team members.\n *\n * Thanks!\n */\nimport { InferenceClientInputError, InferenceClientProviderApiError, InferenceClientProviderOutputError, } from \"../errors.js\";\nimport { getLogger } from \"../lib/logger.js\";\nimport { delay } from \"../utils/delay.js\";\nimport { omit } from \"../utils/omit.js\";\nimport { TaskProviderHelper } from \"./providerHelper.js\";\nconst BLACK_FOREST_LABS_AI_API_BASE_URL = \"https://api.us1.bfl.ai\";\nexport class BlackForestLabsTextToImageTask extends TaskProviderHelper {\n    constructor() {\n        super(\"black-forest-labs\", BLACK_FOREST_LABS_AI_API_BASE_URL);\n    }\n    preparePayload(params) {\n        return {\n            ...omit(params.args, [\"inputs\", \"parameters\"]),\n            ...params.args.parameters,\n            prompt: params.args.inputs,\n        };\n    }\n    prepareHeaders(params, binary) {\n        const headers = {\n            Authorization: params.authMethod !== \"provider-key\" ? `Bearer ${params.accessToken}` : `X-Key ${params.accessToken}`,\n        };\n        if (!binary) {\n            headers[\"Content-Type\"] = \"application/json\";\n        }\n        return headers;\n    }\n    makeRoute(params) {\n        if (!params) {\n            throw new InferenceClientInputError(\"Params are required\");\n        }\n        return `/v1/${params.model}`;\n    }\n    async getResponse(response, url, headers, outputType) {\n        const logger = getLogger();\n        const urlObj = new URL(response.polling_url);\n        for (let step = 0; step < 5; step++) {\n            await delay(1000);\n            logger.debug(`Polling Black Forest Labs API for the result... ${step + 1}/5`);\n            urlObj.searchParams.set(\"attempt\", step.toString(10));\n            const resp = await fetch(urlObj, { headers: { \"Content-Type\": \"application/json\" } });\n            if (!resp.ok) {\n                throw new InferenceClientProviderApiError(\"Failed to fetch result from black forest labs API\", { url: urlObj.toString(), method: \"GET\", headers: { \"Content-Type\": \"application/json\" } }, { requestId: resp.headers.get(\"x-request-id\") ?? \"\", status: resp.status, body: await resp.text() });\n            }\n            const payload = await resp.json();\n            if (typeof payload === \"object\" &&\n                payload &&\n                \"status\" in payload &&\n                typeof payload.status === \"string\" &&\n                payload.status === \"Ready\" &&\n                \"result\" in payload &&\n                typeof payload.result === \"object\" &&\n                payload.result &&\n                \"sample\" in payload.result &&\n                typeof payload.result.sample === \"string\") {\n                if (outputType === \"json\") {\n                    return payload.result;\n                }\n                if (outputType === \"url\") {\n                    return payload.result.sample;\n                }\n                const image = await fetch(payload.result.sample);\n                return await image.blob();\n            }\n        }\n        throw new InferenceClientProviderOutputError(`Timed out while waiting for the result from black forest labs API - aborting after 5 attempts`);\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}